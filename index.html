<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ğŸ›’Ù…ØªØ¬Ø± Ø£ÙØ®Ù… Ø§Ù„Ù…Ù„Ø§Ø¨Ø³ Ù„Ù„Ø£Ø·ÙØ§Ù„  BENAKRAB-shoop</title>

  <style>
    body {
      font-family: "Cairo", sans-serif;
      direction: rtl;
      margin:0;
      padding:0;
      background: linear-gradient(135deg,#eef2f7,#dbeafe);
      color: #2c3e50;
    }

    header {
      background: linear-gradient(135deg,#2563eb,#1e40af);
      color:white;
      text-align:center;
      padding:20px 10px;
      box-shadow:0 4px 10px rgba(0,0,0,0.2);
    }
    header .logo {
      font-size:23px;
      font-weight:bold;
      letter-spacing:1px;
    }
    header .tagline {
      font-size:18px;
      margin-top:4px;
      opacity:0.9;
    }

    /* Ø§Ù„Ø³Ù„Ø§ÙŠØ¯Ø± */
    .slideshow {
      width: 98%;
      max-width:700px;
      margin: 24px auto 6px;
      position:relative;
      overflow:hidden;
      border-radius:14px;
      box-shadow:0 6px 18px rgba(0,0,0,0.18);
      background:#fff;
    }
    .slideshow .slide {
      width:98%;
      display:none;
      border-radius:14px;
    }
    .slideshow .slide.active { display:block; animation: fade 0.9s ease-in-out; }
    @keyframes fade {
      from {opacity:0.4; transform: scale(1.01);}
      to {opacity:1; transform: scale(1);}
    }

    /* Ø§Ù„ÙÙˆØ±Ù… */
    form {
      max-width:700px;
      margin:18px auto 40px;
      padding:22px;
      background:#fff;
      border-radius:14px;
      box-shadow:0 6px 20px rgba(0,0,0,0.12);
    }
    h2 {
      text-align:center;
      color:#2563eb;
      margin-top:6px;
      margin-bottom:10px;
    }
    label { display:block; margin-top:12px; font-weight:bold; color:#344; }
    input, select {
      width:98%;
      padding:10px;
      margin-top:6px;
      font-size:18px;
      border-radius:10px;
      border:1px solid #ccc;
      transition:0.2s;
      box-sizing:border-box;
    }
    input:focus, select:focus {
      border-color:#2563eb;
      box-shadow:0 0 6px rgba(37,99,235,0.18);
      outline:none;
    }
    button {
      margin-top:18px;
      width:98%;
      padding:8px;
      background:#2563eb;
      color:#fff;
      border:none;
      border-radius:12px;
      font-size:18px;
      cursor:pointer;
    }
    button:hover { background:#1e40af; }

    .piece {
      border:2px dashed #2563eb;
      padding:12px;
      border-radius:10px;
      margin-bottom:12px;
      background:#f0f9ff;
    }
    .piece img {
      max-width:240px;
      display:block;
      margin:8px auto;
      border-radius:10px;
      box-shadow:0 4px 10px rgba(0,0,0,0.2);
    }

    #priceDetails {
  margin-top: 14px;
  font-weight: bold;
  color: #118a3b; /* Ø£Ø®Ø¶Ø± ÙˆØ§Ø¶Ø­ */
}

    #successModal {
      display:none;
      position: fixed;
      top:0; left:0; right:0; bottom:0;
      background: rgba(0,0,0,0.56);
      z-index: 9999;
      align-items:center;
      justify-content:center;
    }
    #successModal .modal-content {
      background:#fff;
      padding:18px;
      border-radius:12px;
      width:min(420px,92%);
      margin:0 auto;
      text-align:center;
      box-shadow:0 8px 28px rgba(0,0,0,0.25);
    }
    #successModal h3 { color:#118a3b; margin:6px 0 8px;}
    #successModal p { margin:8px 0;}
    #successModal button { margin-top:10px; padding:10px 20px; border-radius:8px; background:#2563eb; color:white; border:none; cursor:pointer; }

    #loading { display:none; text-align:center; margin-top:12px;}
    #loading img { vertical-align:middle;}

    @media(max-width:520px){
      .slideshow { max-width:94%; }
      form { padding:16px; margin:12px auto 28px;}
    }
  </style>
</head>
<body>

<header>
  <div class="logo">ğŸ›ï¸ BENAKRAB-Shoop</div>
  <div class="tagline">Ø£Ø²ÙŠØ§Ø¡ Ø£Ø·ÙØ§Ù„ Ø¨Ø£Ø­Ø¯Ø« Ø§Ù„Ù…ÙˆØ¯ÙŠÙ„Ø§Øª</div>
</header>

<div class="slideshow" aria-hidden="false">
  <div class="slide active">
    <img src="images/modal1.jpg" alt="Ù…ÙˆØ¯Ø§Ù„ 1">
    <div class="modal-price">ğŸ’° Ø§Ù„Ø³Ø¹Ø±: 3000 Ø¯Ø¬</div>
  </div>
  <div class="slide">
    <img src="images/modal2.jpg" alt="Ù…ÙˆØ¯Ø§Ù„ 2">
    <div class="modal-price">ğŸ’° Ø§Ù„Ø³Ø¹Ø±: 3000 Ø¯Ø¬</div>
  </div>
  <div class="slide">
    <img src="images/modal3.jpg" alt="Ù…ÙˆØ¯Ø§Ù„ 3">
    <div class="modal-price">ğŸ’° Ø§Ù„Ø³Ø¹Ø±:3000 Ø¯Ø¬</div>
  </div>
  <div class="slide">
    <img src="images/modal4.jpg" alt="Ù…ÙˆØ¯Ø§Ù„ 4">
    <div class="modal-price">ğŸ’° Ø§Ù„Ø³Ø¹Ø±: 3000 Ø¯Ø¬</div>
  </div>
  <div class="slide">
    <img src="images/modal5.jpg" alt="Ù…ÙˆØ¯Ø§Ù„ 5">
    <div class="modal-price">ğŸ’° Ø§Ù„Ø³Ø¹Ø±: 3000 Ø¯Ø¬</div>
  </div>
</div>

<style>
.slideshow .slide {
  display:none;
  text-align:center;
  border-radius:14px;
  background:#fff;
  padding:10px;
}
.slideshow .slide.active { display:block; animation: fade 0.9s ease-in-out; }

.slideshow .slide img {
  max-width: 90%;   /* Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ Ù„Ù„Ø¹Ø±Ø¶ */
  max-height: 350px; /* Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ Ù„Ù„Ø§Ø±ØªÙØ§Ø¹ */
  width: auto;
  height: auto;
  border-radius: 12px;
  object-fit: cover; /* ÙŠØ­Ø§ÙØ¸ Ø¹Ù„Ù‰ Ù†Ø³Ø¨Ø© Ø§Ù„ØµÙˆØ±Ø© */
}

.modal-price {
  margin-top:8px;
  font-weight:bold;
  color:#118a3b;
  font-size:18px;
}
</style>
</style>

<h2>ğŸ›’  Ø¥Ù…Ù„Ø£ Ø§Ù„Ø§Ø³ØªÙ…Ø§Ø±Ø© ÙˆØ§Ø·Ù„Ø¨ Ø§Ø­Ø³Ù† Ø§Ù„Ù…ÙˆØ¯ÙŠÙ„Ø§Øª</h2>

<form id="orderForm">
  <label>ğŸ‘¤ Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„:</label>
  <input type="text" name="name" required>

 <label for="phone">ğŸ“ Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ:</label>
    <input type="tel" id="phone" name="phone" 
       dir="rtl"
       placeholder="Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ"
       pattern="^[0-9]{10}$"
       maxlength="10"
       required
       oninvalid="this.setCustomValidity('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ù‡Ø§ØªÙ ØµØ­ÙŠØ­ Ù…ÙƒÙˆÙ† Ù…Ù† 10 Ø£Ø±Ù‚Ø§Ù…')"
       oninput="this.setCustomValidity('')">

  <label>ğŸ“ Ø§Ù„ÙˆÙ„Ø§ÙŠØ©:</label>
  <select id="wilaya" name="wilaya" required></select>

  <label>ğŸ“ Ø§Ù„Ø¯Ø§Ø¦Ø±Ø©:</label>
  <input type="text" name="daire" required>

  <label>ğŸ  Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ÙƒØ§Ù…Ù„:</label>
  <input type="text" name="address" required>

  <div id="piecesContainer"></div>
  <button type="button" onclick="addPiece()">â• Ø£Ø¶Ù Ø¥Ù„Ù‰ Ø§Ù„Ø³Ù„Ø© ğŸ›’ </button>

  <label>ğŸšš Ù†ÙˆØ¹ Ø§Ù„ØªÙˆØµÙŠÙ„:</label>
  <select id="deliveryType" name="deliveryType">
    <option value="home">Ø¥Ù„Ù‰ Ø§Ù„Ù…Ù†Ø²Ù„</option>
    <option value="desk">Ø¥Ù„Ù‰ Ø§Ù„Ù…ÙƒØªØ¨</option>
  </select>

  <div id="priceDetails">
    ğŸ’° Ø§Ù„Ø³Ø¹Ø±: 0 Ø¯Ø¬<br>ğŸ’¸ Ø§Ù„Ø³Ø¹Ø± Ø§Ù„ÙƒÙ„ÙŠ: 0 Ø¯Ø¬
  </div>

  <button type="submit">âœ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨</button>

  <div id="loading">
    <img src="https://i.gifer.com/ZZ5H.gif" alt="Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„..." width="56">
    <p>â³ Ø¬Ø§Ø±ÙŠ Ù…Ø¹Ø§Ù„Ø¬Ø© Ø·Ù„Ø¨Ùƒ...</p>
  </div>
</form>

<div id="successModal" role="dialog" aria-modal="true">
  <div class="modal-content">
    <h3>âœ… ØªÙ… Ø§Ø³ØªÙ‚Ø¨Ø§Ù„ Ø·Ù„Ø¨Ùƒ Ø¨Ù†Ø¬Ø§Ø­!</h3>
    <p>Ø´ÙƒØ±Ù‹Ø§ Ù„Ùƒ Ø¹Ù„Ù‰ Ø·Ù„Ø¨Ùƒ ÙÙŠ BENAKRAB-Shoop.</p>
    <p>Ù„Ù‚Ø¯ ØªÙ… ØªÙˆØ¬ÙŠÙ‡ Ø¬Ù…ÙŠØ¹ Ø¨ÙŠØ§Ù†Ø§Øª Ø·Ù„Ø¨Ùƒ Ù…Ø¨Ø§Ø´Ø±Ø© Ø¥Ù„Ù‰ Ù‚Ø³Ù… Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª Ù„Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©.</p>
    <p>ğŸ“ Ø³ÙŠØªÙˆØ§ØµÙ„ Ù…Ø¹Ùƒ ÙØ±ÙŠÙ‚ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª Ù‚Ø±ÙŠØ¨Ø§ Ù„ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø·Ù„Ø¨ ÙˆØªÙØ§ØµÙŠÙ„ Ø§Ù„ØªÙˆØµÙŠÙ„.</p>
    <p id="totalPrice"></p>
    <button onclick="closeModal()">Ø¥ØºÙ„Ø§Ù‚</button>
  </div>
</div>

<script>
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbxTbY9iQeu8_jnba4_mgYyfq4ey6b7NsZeeTH2WClgvsH1VGCHqZbr2jsqCuui88EVW/exec"; // Ø¹Ø¯Ù‘Ù„

// Ø³Ù„Ø§ÙŠØ¯Ø± Ø§Ù„ØµÙˆØ±
(function initSlider(){
  const slides = document.querySelectorAll(".slideshow .slide");
  let idx = 0;
  if(!slides || slides.length===0) return;
  function show(i){ slides.forEach((s,j)=>s.classList.toggle("active", j===i)); }
  function next(){ idx=(idx+1)%slides.length; show(idx); }
  setInterval(next,3000);
})();

// Ø§Ù„ÙˆÙ„Ø§ÙŠØ§Øª ÙˆØ£Ø³Ø¹Ø§Ø± Ø§Ù„ØªÙˆØµÙŠÙ„
const deliveryPrices = {
  "Ø£Ø¯Ø±Ø§Ø±": { "home": 1100, "desk": 600 },
  "Ø§Ù„Ø´Ù„Ù": { "home": 700, "desk": 400 },
  "Ø§Ù„Ø£ØºÙˆØ§Ø·": { "home": 900, "desk": 500 },
  "Ø£Ù… Ø§Ù„Ø¨ÙˆØ§Ù‚ÙŠ": { "home": 650, "desk": 400 },
  "Ø¨Ø§ØªÙ†Ø©": { "home": 700, "desk": 400 },
  "Ø¨Ø¬Ø§ÙŠØ©": { "home": 700, "desk": 400 },
  "Ø¨Ø³ÙƒØ±Ø©": { "home": 900, "desk": 500 },
  "Ø¨Ø´Ø§Ø±": { "home": 1100, "desk": 600 },
  "Ø§Ù„Ø¨Ù„ÙŠØ¯Ø©": { "home": 500, "desk": 250 },
  "Ø§Ù„Ø¨ÙˆÙŠØ±Ø©": { "home": 700, "desk": 400 },
  "ØªÙ…Ù†Ø±Ø§Ø³Øª": { "home": 1300, "desk": 800 },
  "ØªØ¨Ø³Ø©": { "home": 700, "desk": 400 },
  "ØªÙ„Ù…Ø³Ø§Ù†": { "home": 800, "desk": 400 },
  "ØªÙŠØ§Ø±Øª": { "home": 800, "desk": 400 },
  "ØªÙŠØ²ÙŠ ÙˆØ²Ùˆ": { "home": 700, "desk": 400 },
  "Ø§Ù„Ø¬Ø²Ø§Ø¦Ø±": { "home": 500, "desk": 250 },
  "Ø§Ù„Ø¬Ù„ÙØ©": { "home": 900, "desk": 500 },
  "Ø¬ÙŠØ¬Ù„": { "home": 700, "desk": 400 },
  "Ø³Ø·ÙŠÙ": { "home": 700, "desk": 400 },
  "Ø³Ø¹ÙŠØ¯Ø©": { "home": 800, "desk": 400 },
  "Ø³ÙƒÙŠÙƒØ¯Ø©": { "home": 600, "desk": 400 },
  "Ø³ÙŠØ¯ÙŠ Ø¨Ù„Ø¹Ø¨Ø§Ø³": { "home": 700, "desk": 400 },
  "Ø¹Ù†Ø§Ø¨Ø©": { "home": 700, "desk": 400 },
  "Ù‚Ø§Ù„Ù…Ø©": { "home": 600, "desk": 400 },
  "Ù‚Ø³Ù†Ø·ÙŠÙ†Ø©": { "home": 600, "desk": 400 },
  "Ø§Ù„Ù…Ø¯ÙŠØ©": { "home": 700, "desk": 400 },
  "Ù…Ø³ØªØºØ§Ù†Ù…": { "home": 700, "desk": 400 },
  "Ø§Ù„Ù…Ø³ÙŠÙ„Ø©": { "home": 800, "desk": 400 },
  "Ù…Ø¹Ø³ÙƒØ±": { "home": 700, "desk": 400 },
  "ÙˆØ±Ù‚Ù„Ø©": { "home": 900, "desk": 500 },
  "ÙˆÙ‡Ø±Ø§Ù†": { "home": 800, "desk": 400 },
  "Ø§Ù„Ø¨ÙŠØ¶": { "home": 800, "desk": 500 },
  "Ø¥Ù„ÙŠØ²ÙŠ": { "home": 1300, "desk": 600 },
  "Ø¨Ø±Ø¬ Ø¨ÙˆØ¹Ø±ÙŠØ±ÙŠØ¬": { "home": 700, "desk": 400 },
  "Ø¨ÙˆÙ…Ø±Ø¯Ø§Ø³": { "home": 700, "desk": 400 },
  "Ø§Ù„Ø·Ø§Ø±Ù": { "home": 700, "desk": 400 },
  "ØªÙ†Ø¯ÙˆÙ": { "home": 1300, "desk": 600 },
  "ØªÙŠØ³Ù…Ø³ÙŠÙ„Øª": { "home": 800, "desk": 400 },
  "Ø§Ù„ÙˆØ§Ø¯ÙŠ": { "home": 900, "desk": 500 },
  "Ø®Ù†Ø´Ù„Ø©": { "home": 700, "desk": 500 },
  "Ø³ÙˆÙ‚ Ø£Ù‡Ø±Ø§Ø³": { "home": 700, "desk": 400 },
  "ØªÙŠØ¨Ø§Ø²Ø©": { "home": 700, "desk": 400 },
  "Ù…ÙŠÙ„Ø©": { "home": 500, "desk": 350 },
  "Ø¹ÙŠÙ† Ø§Ù„Ø¯ÙÙ„Ù‰": { "home": 700, "desk": 400 },
  "Ø§Ù„Ù†Ø¹Ø§Ù…Ø©": { "home": 800, "desk": 500 },
  "Ø¹ÙŠÙ† ØªÙ…ÙˆØ´Ù†Øª": { "home": 800, "desk": 400 },
  "ØºØ±Ø¯Ø§ÙŠØ©": { "home": 900, "desk": 500 },
  "ØºÙ„ÙŠØ²Ø§Ù†": { "home": 700, "desk": 400 },
  "ØªÙŠÙ…ÙŠÙ…ÙˆÙ†": { "home": 1100, "desk": 600 },
  "Ø£ÙˆÙ„Ø§Ø¯ Ø¬Ù„Ø§Ù„": { "home": 900, "desk": 500 },
  "Ø¥Ù† ØµØ§Ù„Ø­": { "home": 1300, "desk": 600 },
  "Ø¬Ø§Ù†Øª": { "home": 1100, "desk": 500 }
};

// Ø¥Ø¶Ø§ÙØ© Ø§Ù„ÙˆÙ„Ø§ÙŠØ§Øª Ù„Ù„Ù‚Ø§Ø¦Ù…Ø©
const wilayaSelect = document.getElementById("wilaya");
Object.keys(deliveryPrices).forEach(w=>{
  const opt=document.createElement("option");
  opt.value=w;
  opt.textContent=w;
  wilayaSelect.appendChild(opt);
});

let pieceCount=0;
const UNIT_PRICE=3000;

// Ø¯Ø§Ù„Ø© ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…Ù‚Ø§Ø³ Ø­Ø³Ø¨ Ø§Ù„Ø·ÙˆÙ„ ÙˆØ§Ù„ÙˆØ²Ù†
function getSize(height){
  if(height>=6 && height<=7 ) return "S1";
  if(height>=8 && height<=9) return "S2";
  if(height>=10 && height<=11) return "S3";
  if(height>=12 && height<=13 ) return "S4";
 
  return "ØºÙŠØ± Ù…ØªÙˆÙØ±";
}

function addPiece() {
  pieceCount++;
  const container = document.getElementById("piecesContainer");
  const div = document.createElement("div");
  div.className = "piece";

  const heightOptions = Array.from({length:9}, (_, i) => `<option value="${6+i}">${6+i}  Ø³Ù†ÙˆØ§Øª </option>`).join('');
  const weightOptions = Array.from({length:100}, (_, i) => `<option value="${1+i}">${1+i} ÙƒØº</option>`).join('');
  
  div.innerHTML=`
    <label>ğŸ§© Ø£Ø¶Ù Ø§Ù„Ù‰ Ø§Ù„Ø³Ù„Ø© ğŸ›’:</label>
    <select name="modal${pieceCount}" onchange="showModalImage(this,${pieceCount}); updatePrice();" required>
      <option value="">-- Ø§Ø®ØªØ± Ù…ÙˆØ¯Ø§Ù„ --</option>
      <option value="1">Ù…ÙˆØ¯Ø§Ù„ Ø±Ù‚Ù… 1</option>
      <option value="2">Ù…ÙˆØ¯Ø§Ù„ Ø±Ù‚Ù… 2</option>
      <option value="3">Ù…ÙˆØ¯Ø§Ù„ Ø±Ù‚Ù… 3</option>
      <option value="4">Ù…ÙˆØ¯Ø§Ù„ Ø±Ù‚Ù… 4</option>
      <option value="5">Ù…ÙˆØ¯Ø§Ù„ Ø±Ù‚Ù… 5</option>
    </select>
    <div id="modalImage${pieceCount}" style="margin-top:10px; text-align:center;"></div>

    <label>ğŸ”¢ Ø§Ù„ÙƒÙ…ÙŠØ©:</label>
    <select name="quantity${pieceCount}" onchange="updatePrice()" required>${Array.from({length:10},(_,i)=>`<option value="${i+1}">${i+1}</option>`).join('')}</select>

    <label>ğŸ¨ Ø§Ù„Ù„ÙˆÙ†:</label>
    <select name="color${pieceCount}" required>
      <option value="Ø£Ø¨ÙŠØ¶">Ø£Ø¨ÙŠØ¶</option>
      <option value="Ø£Ø³ÙˆØ¯">Ø£Ø³ÙˆØ¯</option>
      <option value="Ø±Ù…Ø§Ø¯ÙŠ">Ø±Ù…Ø§Ø¯ÙŠ</option>
      <option value="Ø£Ø²Ø±Ù‚">Ø£Ø²Ø±Ù‚</option>
      <option value="Ø£Ø­Ù…Ø±">Ø£Ø­Ù…Ø±</option>
      <option value="Ø£Ø®Ø¶Ø±">Ø£Ø®Ø¶Ø±</option>
    </select>

    <label>ğŸ“ Ø¹Ù…Ø± Ø§Ù„Ø·ÙÙ„:</label>
    <select name="height${pieceCount}" onchange="updateSize(this,${pieceCount})" required>${heightOptions}</select>

   
    <label>ğŸ“ Ø§Ù„Ù…Ù‚Ø§Ø³:</label>
    <input type="text" name="size${pieceCount}" id="size${pieceCount}" readonly>

    <button type="button" onclick="removePiece(this)" style="margin-top:10px; background:#ef4444;">ğŸ—‘ï¸ Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø·Ù„Ø¨</button>
  `;
  container.appendChild(div);
  updatePrice();
}

// Ø¯Ø§Ù„Ø© Ø¥Ø²Ø§Ù„Ø© Ù‚Ø·Ø¹Ø©
function removePiece(button){
  const pieceDiv = button.closest(".piece");
  pieceDiv.remove();
  updatePrice();
}
// ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ù‚Ø§Ø³
function updateSize(select,id){
  const piece=document.querySelector(`.piece:nth-child(${id})`);
  const height=parseInt(piece.querySelector(`select[name^="height"]`).value);
  
  if(height) document.getElementById(`size${id}`).value=getSize(height);
}

// Ø¹Ø±Ø¶ ØµÙˆØ±Ø© Ø§Ù„Ù…ÙˆØ¯Ø§Ù„
function showModalImage(select,id){
  const imgDiv=document.getElementById(`modalImage${id}`);
  const value=select.value;
  if(!value){ imgDiv.innerHTML=""; return; }
  const modalImages={
    "1":"images/modal1.jpg","2":"images/modal2.jpg","3":"images/modal3.jpg",
    "4":"images/modal4.jpg","5":"images/modal5.jpg"
  };
  const img=document.createElement("img");
  img.src=modalImages[value];
  img.alt=`Ù…ÙˆØ¯Ø§Ù„ ${value}`;
  img.style.maxWidth="220px";
  img.onerror=function(){ this.onerror=null; this.src=this.src.replace('/images/','/image/'); };
  imgDiv.innerHTML="";
  imgDiv.appendChild(img);
}

// Ø­Ø³Ø§Ø¨ Ø§Ù„Ø³Ø¹Ø±
function updatePrice(){
  const pieces=document.querySelectorAll(".piece");
  let productPrice=0;
  pieces.forEach(piece=>{
    const qty=parseInt(piece.querySelector('select[name^="quantity"]').value)||0;
    productPrice+=qty*UNIT_PRICE;
  });
  const wilaya=wilayaSelect.value;
  const deliveryType=document.getElementById("deliveryType").value;
  const deliveryCost=deliveryPrices[wilaya] ? (deliveryPrices[wilaya][deliveryType]||0):0;
  const total=productPrice+deliveryCost;
  document.getElementById("priceDetails").innerHTML=`ğŸ’° Ø§Ù„Ø³Ø¹Ø±: ${productPrice} Ø¯Ø¬ + ${deliveryCost} Ø¯Ø¬ ØªÙˆØµÙŠÙ„<br>ğŸ’¸ Ø§Ù„Ø³Ø¹Ø± Ø§Ù„ÙƒÙ„ÙŠ: ${total} Ø¯Ø¬`;
  return total;
}
document.getElementById("orderForm").addEventListener("change",updatePrice);

// Ù†Ø§ÙØ°Ø© Ø§Ù„Ù†Ø¬Ø§Ø­
function showModal(total){
  document.getElementById("totalPrice").textContent=`ğŸ’¸ Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„ÙƒÙ„ÙŠ: ${total} Ø¯Ø¬`;
  document.getElementById("successModal").style.display="flex";
}
function closeModal(){ document.getElementById("successModal").style.display="none"; }

// Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
document.getElementById("orderForm").addEventListener("submit",function(e){
  e.preventDefault();
  const form=document.getElementById("orderForm");
  const formData=new FormData(form);
  formData.set('total',updatePrice());
  document.getElementById("loading").style.display="block";

  fetch(SCRIPT_URL,{method:"POST",body:formData})
    .then(res=>res.text())
    .then(data=>{
      document.getElementById("loading").style.display="none";
      showModal(updatePrice());
      form.reset();
      document.getElementById("piecesContainer").innerHTML="";
      pieceCount=0;
      updatePrice();
    })
    .catch(err=>{
      document.getElementById("loading").style.display="none";
      alert("âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ØŒ Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.");
      console.error(err);
    });
});
</script>

</body>
</html>
